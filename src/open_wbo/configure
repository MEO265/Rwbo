#!/bin/sh

GMP_LFLAGS=""
GMP_CPPFLAGS=""
OPENWBO_WARNFLAGS=""

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"

CXX="$(R CMD config CXX)"

if [ "$(uname -s)" != "Darwin" ]; then
  OPENWBO_WARNFLAGS="-Wno-class-memaccess"
fi

rm -f "$SCRIPT_DIR/conftest_warn.cc" "$SCRIPT_DIR/conftest_warn.o"

sed -e "s|@GMP_LFLAGS@|$GMP_LFLAGS|g" \
  -e "s|@GMP_CPPFLAGS@|$GMP_CPPFLAGS|g" \
  -e "s|@OPENWBO_WARNFLAGS@|$OPENWBO_WARNFLAGS|g" \
  "$SCRIPT_DIR/Makefile.in" > "$SCRIPT_DIR/Makefile.tmp"
mv "$SCRIPT_DIR/Makefile.tmp" "$SCRIPT_DIR/Makefile"

exit 0
